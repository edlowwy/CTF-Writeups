## Challenge: Who are you?

# Challenge Description

Let me in. Let me iiiiiiinnnnnnnnnnnnnnnnnnnn http://mercury.picoctf.net:52362/

# Solution 

When the website doesnt contain any interactive elements, we can always inspect on the webpage source. In this case, there's nothing much but a plain text saying 
>Only people who use the official PicoBrowser are allowed on this site!

<img width="600" src="https://github.com/edlowwy/CTF-Writeups/assets/138736240/44c2a648-10bc-4c03-807c-ec90e0679fe7">
<br>
<br>

Therefore, to intercept and modify the HTTP request in order to access the websiite using the official PicoBrowser we can use [BurpSuit](https://portswigger.net/burp) 

<img width="" src="https://github.com/edlowwy/CTF-Writeups/assets/138736240/61c360d1-781e-4826-8943-c7bc92284a61">

As mentioned, the website can only be accessed using the official PicoBrowser, thus it is mandotory to change the `User-Agent` request to `PicoBrowser` and send the request again.
From the response, we get to see another text written
>I don&#39;t trust users visiting from another site.

So in this case, we can include the `Referer` header into the request along with the [web page URL](http://mercury.picoctf.net:52362/) which allows the server to identify referring pages that we are visiting is from the official site, and send the request again. From the received response, we get to see that there is a text written
>Sorry, this site only worked in 2018.

<img src="https://github.com/edlowwy/CTF-Writeups/assets/138736240/114c741b-0586-4565-ae86-77e298e86778">

Therefore, we include the `Date` header into the request to make the server identify the site is being visited in the year of 2018. Soon a text is found in the response `I don&#39;t trust users who can be tracked.`

<img src="https://github.com/edlowwy/CTF-Writeups/assets/138736240/5bc876d8-c087-4e3b-b837-81cae0f0f93e">

Therefore, we can include the DNT header into the request as `0` to indicate that we prefers not to be tracked on the target site.

<img src="https://github.com/edlowwy/CTF-Writeups/assets/138736240/33478f37-d5b9-4348-afde-0cf930d7ccb4">

The response that given back include a text
>This website is only for people from Sweden.

We can include the `X-Forwarded-For` along with the Sweden IP Address to identify the originating IP address of a us(client) connecting to a web server.

<img src="https://github.com/edlowwy/CTF-Writeups/assets/138736240/28c2bff5-e441-4466-a54b-fea982930a23">

In this time, the text is shown with the newly generated response
>You&#39;re in Sweden but you don&#39;t speak Swedish?


So the only thing we have to do is change the `Accept-Language` to `sv-SE`

<img src="https://github.com/edlowwy/CTF-Writeups/assets/138736240/8f050f57-cf4a-4ef0-82ca-bff77ac3b5a4">




# Flag 

picoCTF{http_h34d3rs_v3ry_c0Ol_much_w0w_0c0db339}


